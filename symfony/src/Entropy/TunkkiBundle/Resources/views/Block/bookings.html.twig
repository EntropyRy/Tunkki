{% extends sonata_block.templates.block_base %}
{% block block %}
<div class="box">
    <div class="box-header">
        <h3 class="box-title">Future Bookings</h3>
    </div>
    <div class="box-body">
    {% for booking in bookings %}
        <div class="box box-solid collapsed-box">
            <div class="box-header {% if booking.IsSomethingBroken %}bg-warning{% endif %}">
                <a href="{{ path('admin_entropy_tunkki_booking_show', {'id':booking.id}) }}">{{ booking.name }} -
                {{ booking.bookingdate|date('d.m.Y') }}</a>
                {% if booking.IsSomethingBroken %}Something is Broken!!{% endif %}
                <div class="box-tools pull-right">
                    <a class="btn btn-default btn-sm" href="{{ path('admin_entropy_tunkki_booking_edit', {'id':booking.id}) }}">
                        <i class="fa fa-pencil-square-o"></i>edit
                    </a>
                    <button class="btn btn-default btn-sm" data-widget="collapse"><i class="fa fa-plus"></i>Show Contents</button>
                </div>
            </div>
            <div style="display: none;" class="box-body">
                <div class="row">
                    <div class="col-md-5">
                    <div>Given away: {{ booking.retrieval|date('d.m.Y H:i') }} by {{ booking.givenAwayBy }}</div>
                    <div>Returning: {{ booking.returning|date('d.m.Y H:i') }} by {{ booking.receivedBy }}</div>
                    </div>
                    <div class="col-md-7">
                    {% if booking.items is not empty %}
                        Items:
                        <ul>
                        {% for item in booking.items %}
                            <li class="
                                {% if item.needsFixing %}btn-danger{% endif %}   
                            ">{{ item }}</li>
                        {% endfor %}
                        </ul>
                    {% endif %}
                    {% if booking.packages is not empty %}
                        {% for package in booking.packages %}
                            Package: {{ package }}
                            <ul>
                            {% for item in package.items %}
                                <li class="
                                    {% if item.needsFixing %}btn-danger{% endif %}   
                                ">{{ item }}</li>
                            {% endfor %}
                            </ul>
                        {% endfor %}
                    {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
    {# dump(bookings) #}
    </div>
</div>        
{% endblock %}
