{% extends 'onecolumn.html.twig' %}
{% use 'pieces/event.html.twig' %}
{% block content %}
    <h1 class="visually-hidden">Entropy ry â€“ {{ 'entropy.seo.description'|trans }}</h1>
        <main role="main" class="row row-cols-1 row-cols-md-2 row-cols-xl-3" {{ stimulus_controller('masonry') }} data-masonry-target="container">
            {% for event in events %}
                {% if app.user %}
                    {% set visible = true %}
                {% else %}
                {% set visible = app.user is null and event.published and (event.publishDate < date()) %}
            {% endif %}
            {% if event is not null and visible %}<div class="col p-2" {{ stimulus_target('masonry', 'item') }}>{{ block('event_tile') }}</div>{% endif %}
        {% endfor %}
        <div class="col p-2" {{ stimulus_target('masonry', 'item') }}>{{ block('epic_tile') }}</div>
        {% if info is not null %}<div class="col p-2" {{ stimulus_target('masonry', 'item') }}>{{ block('artist_tile') }}</div>{% endif %}
        {% if not app.user %}<div class="col p-2" {{ stimulus_target('masonry', 'item') }}>{{ block('join_us_tile') }}</div>{% endif %}
            <div class="col p-2" {{ stimulus_target('masonry', 'item') }}>{{ block('stream_tile') }}</div>
        </main>
{% endblock %}
{% block epic_tile %}
    <div class="tile col-12 p-2">
        <twig:EPicsRandom defaultImage="{{ asset('/images/header-logo.svg') }}" refreshInterval="8000" />
        <h2 class="h4">{{ 'epics.tile.heading'|trans }} {{ 'epics.tile.heading_events'|trans }}.</h2>
        <div class="justify-content-between d-flex">
            <a class="btn btn-outline-primary" href="https://epics.entropy.fi">{{ 'epics.tile.more_button'|trans }}</a>
            <a class="btn btn-outline-primary"
               href="{{ 'url.events'|trans }}">{{ 'epics.tile.events_button'|trans }}</a>
        </div>
    </div>
{% endblock %}
{% block join_us_tile %}
    <div class="tile col-12 p-2">
        <div class="rect-img-container">
            <img src="{{ asset('/images/golden-logo.svg') }}" loading="lazy" class="rect-img fill" title="{{ 'Join us'|trans }}">
        </div>
        <h2 class="h4">{{ 'join_us.title'|trans }}</h2>
        <p>{{ 'join_us.1'|trans }}</p>
        <ul>
            <li>{{ 'join_us.2'|trans }}</li>
            <li>{{ 'join_us.3'|trans }}</li>
            <li>{{ 'join_us.4'|trans }}</li>
        </ul>
        <div class="justify-content-between d-flex">
            <a class="btn btn-primary"
               href="{{ 'url.join_us'|trans }}">{{ 'join_us.button'|trans }}</a>
            <a data-turbo="false"
               class="btn btn-primary"
               href="https://entropy.fi/mm">{{ 'join_us.mattermost'|trans }}</a>
        </div>
    </div>
{% endblock %}
{% block artist_tile %}
    {% set artist = info.artistClone %}
    {% set event = info.event %}
    {% set name = (artist.name|split(' for')).0 %}
    {% set frontpage = true %}
    {# bio_attribute removed: using artist.bio / artist.bioEn directly elsewhere #}
    <div class="tile col-12 p-2">
        <a href="{{ block('event_path') }}">
            <div class="rect-img-container">
                {{ block('artist_pic') }}
                <div class="badge-container">
                    <span class="badge bg-secondary">{{ 'artist.tile.heading'|trans }}</span>
                </div>
            </div>
        </a>
        {# <h4>{{'artist.tile.heading'|trans}}: {{name}}</h4> #}
        <div class="mb-2 justify-content-between d-flex">
            {% if app.request.locale == 'fi' %}
                {% set artist_url = 'url.artists'|trans %}
            {% else %}
                {% set artist_url = 'url.artists'|trans %}
            {% endif %}
            <a class="btn btn-outline-primary" href="{{ block('event_path') }}">{{ 'artist.tile.button_event'|trans }}</a>
            <a class="btn btn-outline-primary" href="{{ artist_url }}">{{ 'artist.tile.button_artists'|trans }}</a>
        </div>
        {{ block('artist_event_info') }}
    </div>
{% endblock %}
{% block stream_tile %}
    <div {{ stimulus_controller('stream') }} data-stream-url-value="https://stream.entropy.fi" data-stream-online-img-value="{{ asset('/images/entropy-stream-online.svg') }}" data-stream-offline-img-value="{{ asset('/images/entropy-stream-offline.svg') }}" data-stream-refresh-interval-value="20000">
        <div class="tile col-12 p-2">
            <a href="{{ 'url.stream'|trans }}">
                <div class="rect-img-container">
                    <img data-stream-target="pic" src="{{ asset('/images/entropy-stream-offline.svg') }}" loading="lazy" class="rect-img fill stream-img" title="{{ 'Stream'|trans }}">
                    <div class="badge-container">
                        <span data-stream-target="badge" class="badge bg-secondary">{{ 'loading'|trans }}..</span>
                    </div>
                </div>
            </a>
            <div class="mb-2 justify-content-between d-flex">
                <div data-stream-target="player" class="audioplayer d-none mt-4">
                    <audio controls="controls" preload="none">
                        <source data-stream-target="source"
                                src="https://stream.entropy.fi/kerde.mp3"
                                type="audio/mpeg" />
                    </audio>
                </div>
            </div>
            <a class="btn btn-primary w-100" href="{{ 'url.stream'|trans }}">
                {{ 'stream.tile.button'|trans }}
            </a>
        </div>
    </div>
{% endblock %}
